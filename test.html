<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>IgniteX Hive · GAS Web App Test</title>
  <style>body{font-family:system-ui,Segoe UI,Roboto,sans-serif;max-width:760px;margin:40px auto;padding:0 16px}pre{background:#111;color:#eee;padding:12px;border-radius:8px;overflow:auto}</style>
</head>
<body>
  <h1>GAS Web App Test</h1>
  <p>
    <label>Web App URL:</label><br/>
    <input id="url" style="width:100%" value="https://script.google.com/macros/s/AKfycbwSk2SoBcYyS0Su-4CJkhPycpc6EfAPBTDVbXinkH-3hsvAiEnaAnTwOv3BDdL2yJt_/exec">
  </p>
  <p>
    <button id="btnGet">GET ping</button>
    <button id="btnPost">POST signup</button>
  </p>
  <pre id="out">Ready…</pre>

<script>
const $ = id => document.getElementById(id);
function show(x){ $('out').textContent = x; }

$('btnGet').addEventListener('click', async () => {
  const u = $('url').value.trim();
  show('GET ' + u + ' …');
  try {
    const res = await fetch(u, { method: 'GET' });
    const txt = await res.text();
    show('Status: ' + res.status + '\n\n' + txt);
  } catch (e) {
    show('GET failed: ' + e.message);
  }
});

$('btnPost').addEventListener('click', async () => {
  const u = $('url').value.trim();
  show('POST ' + u + ' …');
  try {
    const fd = new FormData();
    fd.append('action','signup');
    fd.append('name','Test User');
    fd.append('address','123 Sample Street, KL');
    fd.append('email','test@example.com');
    fd.append('nationality','Malaysian');
    fd.append('xrpTag','1234567890');  // 10 digits
    fd.append('succTag','0987654321'); // 10 digits
    fd.append('telegram','@testuser');
    fd.append('clientTs', new Date().toISOString());

    const res = await fetch(u, { method: 'POST', body: fd });
    const txt = await res.text(); // read text first (in case of non-JSON errors)
    try {
      const json = JSON.parse(txt);
      show('Status: ' + res.status + '\n\n' + JSON.stringify(json, null, 2));
    } catch {
      show('Status: ' + res.status + '\n\n' + txt);
    }
  } catch (e) {
    show('POST failed: ' + e.message);
  }
});
</script>
</body>
</html>
